# 更新日志

简体中文 · [英文](CHANGELOG.md)

本文件记录 Antigravity Cockpit 扩展的所有重要变更。

格式参考 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)。

---

## [1.5.23] - 2025-12-23

### 改进
- **进程检测**: 优化 Antigravity 进程检测逻辑，要求必须包含服务端口和 CSRF Token，移除不准确的路径匹配以消除误报。
- **体积优化**: 通过新增 `.vscodeignore` 排除源码、Source Map 和演示截图，插件包体积缩减约 67%。
- **工程化完善**: 修复所有 Lint 错误，更新 TS 配置以支持现代 ESM 导入语法。

### 修复
- **状态栏**: 修正状态栏悬浮预览中套餐名称的显示。

## [1.5.22] - 2025-12-22

### 修复
- **面板更新**：修复了自动刷新时若面板在后台，切换回来数据未更新的问题。
- **配额精度**：修复了仪表盘（列表视图）与状态栏配额百分比显示不一致的问题，现已统一为向下取整。

## [1.5.21] - 2025-12-22

### 改进
- **文档**：重写 README，整合功能列表

---

## [1.5.20] - 2025-12-21

### 新增
- **QuickPick 模式**：完整分组模式支持，与 Webview 分组功能一致
- **QuickPick 模式**：标题栏操作按钮（刷新、切换分组、日志、设置、Webview）
- **QuickPick 模式**：自动分组按钮（仅分组模式下显示）
- **QuickPick 模式**：每个模型/分组项的重命名和重置按钮
- **QuickPick 模式**：刷新冷却机制，防止频繁连续刷新

### 改进
- **QuickPick 模式**：操作从列表项移至标题栏按钮，界面更简洁
- **QuickPick 模式**：进度条和重置时间移至详情行，对齐更整齐
- **翻译**：为全部 13 种支持语言添加 QuickPick 专属翻译

### 修复
- **显示模式**：在 Webview 和 QuickPick 之间切换时分组状态正确保持

---

## [1.5.19] - 2025-12-21

### 改进
- **QuickPick 模式**：切换"固定到状态栏"时改为局部刷新，只更新被点击的项，不再重建整个列表
- **QuickPick 模式**：移除冗余的状态图标（对号/警告/错误），仅保留固定图标，界面更简洁

---

## [1.5.18] - 2025-12-19

### 改进
- **代码架构**：重构 `extension.ts` 为模块化控制器，提升可维护性和性能。
- **UI 对齐**：修复 Windows 平台下进度条对齐问题，改用跨平台兼容的方块字符。

## [1.5.17] - 2025-12-19

### 新增
- **列表视图模式**：新增表格样式的配额展示视图
  - 通过 设置 → 视图模式（卡片/列表）切换

---

## [1.5.16] - 2025-12-19

### 新增
- **多语言支持扩展**：国际化支持从 2 种语言扩展到 14 种语言
  - 🇺🇸 English (en) - 英语
  - 🇨🇳 简体中文 (zh-cn)
  - 🇯🇵 日本語 (ja) - 日语 - 新增
  - 🇪🇸 Español (es) - 西班牙语 - 新增
  - 🇩🇪 Deutsch (de) - 德语 - 新增
  - 🇫🇷 Français (fr) - 法语 - 新增
  - 🇧🇷 Português do Brasil (pt-br) - 巴西葡萄牙语 - 新增
  - 🇷🇺 Русский (ru) - 俄语 - 新增
  - 🇰🇷 한국어 (ko) - 韩语 - 新增
  - 🇮🇹 Italiano (it) - 意大利语 - 新增
  - 🇹🇼 繁體中文 (zh-tw) - 繁体中文 - 新增
  - 🇹🇷 Türkçe (tr) - 土耳其语 - 新增
  - 🇵🇱 Polski (pl) - 波兰语 - 新增
  - 🇨🇿 Čeština (cs) - 捷克语 - 新增

### 改进
- **模块化翻译**：重构国际化架构，使用独立翻译文件，便于维护
- **语言检测优化**：增强语言环境检测，支持语言变体的自动回退映射

---

## [1.5.15] - 2025-12-18

### 改进
- **模型能力展示**：新增模型能力悬浮提示，悬停模型名称即可查看详细能力。
- **智能分组兜底**：优化“自动分组”逻辑，增加兜底分组策略。

---

## [1.5.14] - 2025-12-18

### 改进
- **分组模式引导**：在分组模式顶部添加说明文案，引导用户使用自动分组和模式切换功能

## [1.5.13] - 2025-12-18

### 新增
- **首次启动自动分组**：当分组功能已启用但尚无分组映射时，首次启动自动计算并保存分组

---

## [1.5.12] - 2025-12-17

### 修复
- **状态颜色**：状态球颜色调整回更鲜艳的色调（使用终端/图表高亮色，替代较暗的图标色）

---

## [1.5.11] - 2025-12-16

### 新增
- **名称+数字模式**：新增状态栏格式 `Sonnet: 95%`（不带状态球）

### 变更
- **状态栏选择器**：从按钮组改为下拉框，界面更简洁
- **设置标题**：从"提醒设置"简化为"设置"
- **设置自动保存**：所有设置立即生效，无需手动保存
- **阈值自动调整**：超出范围的值自动调整为有效值

### 修复
- **设置弹框保持**：数据自动刷新时弹框不再关闭

---

## [1.5.1] - 2025-12-16

### 新增
- **重置名称按钮**：重命名弹框新增"重置"按钮，可快速恢复原始名称

### 修复
- **状态栏同步**：自定义模型名称现在会正确显示在状态栏中（非分组模式）

### 改进
- **主题适配**：使用 VS Code 主题变量适配颜色（Tooltip、语义色、标签等）

---

## [1.5.0] - 2025-12-16

### 新增
- **模型重命名**：在非分组模式下可以重命名单个模型（点击模型卡片上的 ✏️ 图标）
- **状态栏样式选择器**：在设置面板中提供 5 种状态栏显示模式
  - 仅图标（`🚀`）
  - 仅状态球（`🟢` | `🟡` | `🔴`）
  - 仅数字（`95%`）
  - 状态球+数字（`🟢 95%`）
  - 完整显示（`🟢 Sonnet: 95%`）- 默认

### 变更
- 设置面板新增状态栏样式选择器，支持实时预览
- 自定义模型名称跨会话持久化保存

---

## [1.4.24] - 2025-12-15

### 变更
- QuickPick 模式：使用 Emoji 图标，确保在所有主题下始终可见

---

## [1.4.23] - 2025-12-15

### 新增
- QuickPick 模式：添加「切换到 Webview 模式」按钮，方便切换显示模式

---

## [1.4.22] - 2025-12-15

### 新增
- QuickPick 兼容模式：使用 VSCode 原生 QuickPick API 替代 Webview
- 更好兼容 Webview 不受支持的环境
- 通过 `agCockpit.displayMode: "quickpick"` 配置启用
- 功能：查看所有模型配额、切换状态栏固定、刷新数据
- Webview 加载失败时自动引导用户切换到 QuickPick 模式

---

## [1.4.21] - 2025-12-15

### 变更
- 文档：拆分中英文 README 与更新日志，并加入语言切换链接
- 文档：以 Open VSX 徽章/链接作为主要分发渠道

---

## [1.4.20] - 2025-12-15

### 修复
- 修复启动时服务未就绪（500 错误）导致的 `Cannot read properties of undefined` 崩溃问题
- 添加服务器响应验证，提供更清晰的错误信息

### 新增
- 启动时自动重试机制：首次同步失败会自动重试最多 3 次

---

## [1.4.19] - 2025-12-13

### 安全
- 诊断日志中的敏感信息（csrf_token）脱敏处理，防止信息泄露

---

## [1.4.18] - 2025-12-13

### 新增
- 创建独立的 `CHANGELOG.md` 文件，记录所有历史版本更新

### 变更
- README 中的 Changelog 章节改为引用独立文件
- 移除冗余的 `activationEvents` 配置（VS Code 自动生成）

---

## [1.4.17] - 2025-12-13

### 新增
- 启动日志中显示插件版本号，方便问题排查

---

## [1.4.16] - 2025-12-13

### 修复
- 优化进程识别逻辑，精准匹配 Antigravity 进程
- 避免误识别 Windsurf 等其他编辑器进程
- 强制要求 `--app_data_dir antigravity` 参数或路径包含 `antigravity`

---

## [1.4.15] - 2025-12-13

### 修复
- 修复所有 ESLint 错误（23 个错误 → 0）
- 将 `require()` 改为 ES6 动态 `import()`
- 为 case 块添加花括号作用域
- 修复 TypeScript `any` 类型警告

### 改进
- 增强 Windows 进程检测容错性
- 添加 PowerShell/WMIC 双向自动切换机制
- 添加切换次数限制防止无限循环
- PowerShell 冷启动等待时间从 1秒 增加到 2秒
- 检测 PowerShell 执行策略和 WMI 服务问题
- 增强诊断信息，提供用户友好的故障排除提示

---

## [1.4.14] - 2025-12-12

### 修复
- 修复多进程场景下的进程检测问题
- 改进进程验证逻辑

---

## [1.4.13] - 2025-12-12

### 变更
- 分组重命名改用模态框输入
- 移除仪表盘中的"最后更新时间"显示

---

## [1.4.12] - 2025-12-12

### 修复
- 修复 PowerShell 冷启动超时问题
- 增加进程命令执行超时时间至 8 秒

---

## [1.4.11] - 2025-12-12

### 变更
- 版本号整理

---

## [1.4.1] - 2025-12-11

### 新增
- 添加阈值通知开关，支持用户控制是否弹窗提醒

### 修复
- 修复通知开关状态未正确传递到前端的问题
- 修复点击状态栏和刷新缓存时阈值颜色判断错误的问题

---

## [1.4.0] - 2025-12-11

### 新增
- 可配置的警告/危险阈值
- 快捷键支持（查看日志、打开仪表盘等）
- 反馈入口（GitHub Issues）
- 阈值通知功能

### 改进
- 优化配额判断逻辑
- 统一颜色显示标准

---

## [1.3.14] - 2025-12-10

### 新增
- 添加备用关键字搜索（通过 `csrf_token` 查找进程）

### 修复
- 修复 PowerShell 引号转义问题

---

## [1.3.12] - 2025-12-08

### 修复
- 修正仪表盘状态逻辑
- 完善国际化支持
- Tooltip 中使用完整模型名称

---

## [1.3.1] - 2025-12-07

### 新增
- 状态栏彩色指示器（🟢🟡🔴）
- 统一的三色状态逻辑

### 改进
- 精度修复
- 工具提示模型顺序与仪表盘一致

---

## [1.3.0] - 2025-12-07

### 新增
- Tooltip 对齐优化
- 统一阈值配置
- 自动重试机制

---

## [1.2.16] - 2025-12-06

### 新增
- 首次切换到分组模式时自动分组

---

## [1.2.15] - 2025-12-06

### 新增
- 手动自动分组功能
- 持久化分组映射

---

## [1.2.13] - 2025-12-05

### 修复
- 确保自动置顶在 UI 刷新前执行

---

## [1.2.12] - 2025-12-05

### 修复
- 使用基于模型 ID 的稳定 groupId

---

## [1.2.11] - 2025-12-05

### 修复
- 多项改进和错误修复

---

## [1.2.1] - 2025-12-04

### 修复
- 首次启用分组时自动置顶所有分组

---

## [1.2.0] - 2025-12-04

### 新增
- 配额分组功能
- 分组自定义名称
- 分组拖拽排序
- 分组状态栏显示

---

## [1.1.153] - 2025-12-03

### 新增
- 使用趋势图可见性切换

---

## [1.1.152] - 2025-12-03

### 新增
- 配额历史图表（7 天数据保留）

---

## [1.1.151] - 2025-12-02

### 改进
- 简化用户资料控制
- 数据掩码改用文本按钮
- 可见性切换移至头部

---

## [1.1.150] - 2025-12-02

### 新增
- 用户资料可见性切换
- 敏感数据掩码功能

---

## [1.1.149] - 2025-12-02

### 新增
- 隐私模式
- 用户资料可见性切换

---

## [1.1.148] - 2025-12-01

### 修复
- 移除 Prompt Credits 设置
- 配置变更时自动更新状态栏

---

## [1.1.147] - 2025-12-01

### 修复
- 连接失败时自动重新扫描

---

## [1.1.146] - 2025-11-30

### 修复
- 状态栏错误状态未清除的问题

---

## [1.1.144] - 2025-11-30

### 变更
- 将"User ID"重命名为"Internal Tier ID"

---

## [1.1.143] - 2025-11-29

### 新增
- 详细用户资料字段本地化

---

## [1.1.142] - 2025-11-29

### 改进
- 上下文窗口逻辑移至固定区域

---

## [1.1.14] - 2025-11-28

### 新增
- 完整的用户资料详情
- 状态持久化

---

## [1.1.13] - 2025-11-27

### 改进
- 优化 UI 交互
- 修复置顶切换功能

---

## [1.1.12] - 2025-11-27

### 改进
- 增强调试日志
- 优化刷新行为

---

## [1.1.11] - 2025-11-26

### 修复
- 使用向下取整百分比，避免误导性的 100%

---

## [1.0.0] - 2025-11-25

### 新增
- 首次发布 🎉
- 沉浸式仪表盘
- 精确定时刷新
- 交互式控制（拖拽排序、置顶模型）
- 智能状态栏
- 智能通知
- 中英文双语支持
- 跨平台支持（Windows / macOS / Linux）

